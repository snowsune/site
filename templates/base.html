<!DOCTYPE html>
<html lang="en">
{% load static %}
{% load image_tags %}


<head>
  <!-- Dark Mode Script! -->
  <script>
    // Set theme class before load!
    if (localStorage.getItem("darkMode") === "enabled" || window.matchMedia("(prefers-color-scheme: dark)").matches) {
      document.documentElement.classList.add("dark-mode");
    }
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Snowsune.net{% endblock %}</title>

  {% block header %}{% endblock %}

  <!-- Default Meta Tags -->
  <meta name="description"
    content="{% block meta_description %}Welcome to Snowsune.net! Vixi's website for projects, tools, comics, and more!{% endblock %}" />
  <meta name="keywords"
    content="{% block meta_keywords %}Snowsune, Vixi, Vixi Argorrok, Rhettan, Alice Prairie, projects, blog, tools, comics, furry, art, webcomic, discord, server, hangout, community, furry art, digital art, character art, commission, commission organizer, furry community, online tools, web development, creative projects{% endblock %}" />
  <meta name="author" content="Vixi" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="{% block canonical_url %}https://snowsune.net{% endblock %}" />

  <!-- Additional SEO Meta Tags -->
  <meta name="language" content="en" />
  <meta name="revisit-after" content="7 days" />
  <meta name="distribution" content="global" />
  <meta name="rating" content="general" />
  <meta name="subject"
    content="{% block meta_subject %}Furry Art, Webcomics, Creative Tools, Community{% endblock %}" />
  <meta name="category" content="{% block meta_category %}Art, Comics, Tools, Community{% endblock %}" />

  <!-- Open Graph / Discord Embed -->
  <meta property="og:title" content="{% block og_title %}Snowsune.net{% endblock %}" />
  <meta property="og:description"
    content="{% block og_description %}Vixi's website for projects, tools, comics, and more!{% endblock %}" />
  <meta property="og:image"
    content="{% block og_image %}{% static 'placeholders/placeholder_wide.png' %}{% endblock %}" />
  <meta property="og:url" content="{% block og_url %}https://snowsune.net{% endblock %}" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Snowsune.net" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt"
    content="{% block og_image_alt %}Snowsune.net - Vixi's personal website{% endblock %}" />

  <!-- Twitter Card (not because I like twitter, only for compat in apps that accept the summary_large) -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{% block twitter_title %}Snowsune.net{% endblock %}" />
  <meta name="twitter:description"
    content="{% block twitter_description %}Vixi's website for projects, tools and more!{% endblock %}" />
  <meta name="twitter:image"
    content="{% block twitter_image %}{% static 'placeholders/placeholder_wide.png' %}{% endblock %}" />
  <meta name="twitter:image:alt"
    content="{% block twitter_image_alt %}Snowsune.net - Vixi's personal website{% endblock %}" />
  <meta name="twitter:site" content="@snowsune" />
  <meta name="twitter:creator" content="@vixi" />

  <!-- DuckDuckGo specific meta tags -->
  <meta name="theme-color" content="#2222ff" />
  <meta name="msapplication-TileColor" content="#2222ff" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <!-- Favicon -->
  <link rel="stylesheet" href="{% static 'css/base.css' %}" />
  <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}" />

  <!-- Extra CSS block for page-specific styles -->
  {% block extra_css %}{% endblock %}

  <!-- Extra head content block for page-specific meta tags, scripts, etc. -->
  {% block extra_head %}{% endblock %}

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Snowsune.net",
    "description": "{% block schema_description %}Vixi's website for projects, tools, comics, and more!{% endblock %}",
    "url": "https://snowsune.net",
    "author": {
      "@type": "Person",
      "name": "Vixi",
      "alternateName": "Vixi Argorrok"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Snowsune.net"
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://snowsune.net/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <!-- Other -->
  <link rel="stylesheet" href="https://furriesofnewengland.org/css/onionring.css" />
  <!-- Required for FONE <3 -->
</head>

<body class="{% if user.is_authenticated %}user-authenticated{% else %}user-anonymous{% endif %}">
  <header class="header tile">
    <div class="header-left">
      <div class="logo">
        <img src="{% if debug %}{% static 'logos/devlogo.png' %}{% else %}{% static 'logos/logo.png' %}{% endif %}"
          alt="Snowsune Logo" />
        <div class="live-stats">
          <span class="active-users" title="Users online! (Last 15 Minutes)">üë• <span id="active-users-count">-</span>
            online</span>
          <span class="server-offset" title="Percent of server energy provided by solar!">‚òÄÔ∏è <span
              id="server-offset">-</span>%</span>
        </div>
      </div>
      <nav class="navbar">
        <div class="nav-links">
          <a href="{% url 'home' %}">Home</a>
          <a href="{% url 'tools' %}">Apps/Tools</a>
          <a href="{% url 'blog:blog_list' %}">Blog</a>
          <a href="{% url 'comics:comic_home' %}">Comics</a>
        </div>
        <div class="nav-mobile-links" id="nav-mobile-links">
          <a href="{% url 'home' %}">Home</a>
          <a href="{% url 'tools' %}">Apps/Tools</a>
          <a href="{% url 'blog:blog_list' %}">Blog</a>
          <a href="{% url 'comics:comic_home' %}">Comics</a>
        </div>
      </nav>
    </div>
    <div class="header-right">
      <div class="login">
        <button class="nav-hamburger" id="nav-hamburger" aria-label="Open navigation">&#9776;</button>
        {% if discord_invite %}
        <a href="{{ discord_invite }}" target="_blank" rel="noopener" class="discord-navbar-btn">
          <span class="discord-navbar-icon">üí¨</span> Join my Discord!
        </a>
        {% endif %}
        {% include "users/widget.html" %}
      </div>
    </div>
  </header>

  <!-- The stuff in the center of the page basically -->
  <div class="main-layout">
    <!-- Main content -->
    <div class="content tile">
      {% block content %}
      <!-- Page-specific content goes here -->
      {% endblock %}
    </div>

    <!-- Sidebar stuff -->
    <div class="sidebar tile">
      <h2>Global Links</h2>
      <ul>
        <li><a href="{% url 'home' %}">About</a></li>
        <!-- TODO: Change me to a proper about page later -->
        <li><a href="{% url 'tools' %}">Tools</a></li>
        <li><a href="{% url 'blog:blog_list' %}">Blog</a></li>
      </ul>
      {% block sidebar %} {% endblock %}

      <!-- This adds us to the FONE ring! -->
      <div id="fone-ring">
        <script type="text/javascript" src="https://furriesofnewengland.org/js/onionring-variables.js"></script>
        <script type="text/javascript" src="https://furriesofnewengland.org/js/onionring-widget.js"></script>
      </div>
    </div>
  </div>

  <footer class="footer tile">
    <div class="footer-content">
      <div class="footer-main">
        <p>
          &copy; {{ year }} snowsune.net,
          <a href="https://github.com/snowsune/site/commits/{{ version }}">Version {{ version }}</a>
          ‚Ä¢ Today's visits: {{ today_visits }} ‚Ä¢ Today's unique visitors: {{ today_unique_visitors }} ‚Ä¢ Art by
          <a href="https://mothwingart.carrd.co/">Mothwing</a>
          and others! ‚Ä¢ If you think my site is helpful consider
          <a href="https://ko-fi.com/snowsune">Supporting me!</a>
        </p>
      </div>

      <div class="footer-links">
        <a href="{% url 'thank_you' %}" class="footer-credit-link">
          <span class="footer-credit-icon">üíù</span>
          Credits & Thank You
        </a>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const hamburger = document.getElementById('nav-hamburger');
      const mobileLinks = document.getElementById('nav-mobile-links');
      if (hamburger && mobileLinks) {
        hamburger.addEventListener('click', function () {
          mobileLinks.classList.toggle('open');
        });
        // Optional: close menu when a link is clicked
        mobileLinks.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', () => mobileLinks.classList.remove('open'));
        });

        // Close menu when clicking something other than the hamburger button or mobile menu
        // Thank you Kyte!!
        document.addEventListener('click', function (event) {
          // Check if click is outside both the hamburger button and mobile menu
          if (!hamburger.contains(event.target) && !mobileLinks.contains(event.target)) {
            mobileLinks.classList.remove('open');
          }
        });
      }

      // Convert Django messages to notifications
      const djangoMessages = document.querySelectorAll('.message');
      djangoMessages.forEach(message => {
        const type = message.classList.contains('message-success') ? 'success' :
          message.classList.contains('message-error') ? 'error' :
            message.classList.contains('message-warning') ? 'warning' :
              message.classList.contains('message-info') ? 'info' : 'info';

        const text = message.querySelector('.message-text')?.textContent || message.textContent;

        // Show as notification and remove Django message
        window.notifications.show(text, type);
        message.remove();
      });
    });
  </script>

  <!-- Centralized Notification System -->
  <script src="{% static 'js/notifications.js' %}"></script>

  <!-- Live Stats Script -->
  <script src="{% static 'js/live-stats.js' %}"></script>

  {% block extra_js %}{% endblock %}
</body>

</html>